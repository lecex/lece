stages:
- name: App
  steps:
  - applyAppConfig:
      catalogTemplate: cattle-global-data:library-redis
      version: 9.0.2
      answers:
        cluster.slaveCount: "2"
        master.persistence.enabled: "true"
        slave.persistence.enabled: "true"
      name: redis
      targetNamespace: api
  - applyAppConfig:
      catalogTemplate: cattle-global-data:github-nats
      version: 4.3.7
      answers:
        auth.enabled: "false"
        replicaCount: "5"
      name: nats
      targetNamespace: srv
- name: Config
  steps:
  - applyYamlConfig:
      path: ./rancher/config.yaml
- name: Micro
  steps:
  - applyYamlConfig:
      path: ./rancher/app/micro-rpc.yaml
  - applyYamlConfig:
      path: ./rancher/app/micro-api.yaml
- name: User
  steps:
  - applyYamlConfig:
      path: ./rancher/app/user.yaml
  - applyYamlConfig:
      path: ./rancher/app/user-api.yaml
